# Запуск локальной сети Volnix Protocol

Этот скрипт запускает локальную тестовую сеть из 3 узлов с кошельком и блокчейн-эксплорером.

## Требования

- Go 1.21+
- Node.js 18+
- npm
- Python 3 (для blockchain-explorer)

## Использование

### Базовый запуск

```bash
./scripts/start-local-network.sh
```

### Запуск с очисткой существующих данных

```bash
./scripts/start-local-network.sh --clean
```

## Что запускается

1. **3 узла блокчейна:**
   - node0: P2P порт 26656, RPC порт 26657
   - node1: P2P порт 26666, RPC порт 26667
   - node2: P2P порт 26676, RPC порт 26677

2. **Wallet UI:**
   - URL: http://localhost:3000
   - React приложение для управления кошельком

3. **Blockchain Explorer:**
   - URL: http://localhost:8080
   - Веб-интерфейс для просмотра блоков и транзакций

## Структура

После запуска создаются следующие директории:

- `testnet/` - данные узлов (конфигурация, ключи, база данных)
- `logs/` - логи всех компонентов
- `build/` - скомпилированный бинарник volnixd

## Остановка

Нажмите `Ctrl+C` для остановки всех процессов. Скрипт автоматически остановит:
- Все узлы блокчейна
- Wallet UI сервер
- Blockchain Explorer сервер

## Просмотр логов

```bash
# Логи узла
tail -f logs/node0.log

# Логи кошелька
tail -f logs/wallet-ui.log

# Логи эксплорера
tail -f logs/explorer.log
```

## Проверка статуса

```bash
# Статус узла
./build/volnixd status --home testnet/node0

# Проверка RPC эндпоинта
curl http://localhost:26657/status
```

## Устранение проблем

### Порты заняты

Если порты уже заняты, измените `BASE_PORT` в скрипте или остановите процессы, использующие эти порты:

```bash
# Найти процессы на портах
lsof -i :26657
lsof -i :3000
lsof -i :8080

# Остановить процесс
kill -9 <PID>
```

### Ошибки сборки

Убедитесь, что все зависимости установлены:

```bash
# Go зависимости
go mod download

# Node.js зависимости
cd frontend/wallet-ui && npm install
```

### Очистка и перезапуск

Для полной очистки и перезапуска:

```bash
# Остановить все процессы
pkill -f volnixd
pkill -f "npm.*start"
pkill -f "python3.*http.server"

# Удалить данные
rm -rf testnet logs

# Запустить заново
./scripts/start-local-network.sh --clean
```

## Настройка

Вы можете изменить параметры в начале скрипта:

- `NODE_COUNT` - количество узлов (по умолчанию 3)
- `CHAIN_ID` - ID блокчейна (по умолчанию "volnix-testnet")
- `BASE_PORT` - базовый порт для узлов (по умолчанию 26656)

## Примечания

- Первый запуск может занять время из-за сборки и установки зависимостей
- Узлы автоматически подключаются друг к другу через persistent_peers
- Wallet UI и Explorer подключаются к первому узлу (node0) по умолчанию

